apiVersion: 'gateway.networking.k8s.io/v1'
kind: 'HTTPRoute'
metadata:
  name: 'oidc'
spec:
  parentRefs:
    - name: 'ts-internal'
  hostnames:
    - 'oidc.sko.ai'
  rules:
    - matches:
        - path:
            type: 'PathPrefix'
            value: '/'
---
apiVersion: 'gateway.envoyproxy.io/v1alpha1'
kind: 'SecurityPolicy'
metadata:
  name: 'oidc'
spec:
  targetRefs:
    - group: 'gateway.networking.k8s.io'
      kind: 'Gateway'
      name: 'ts-internal'
  oidc:
    provider:
      issuer: 'https://pi.sko.ai'
    clientID: '2727a3d2-01de-4a80-974f-2d95b11686ad'
    clientSecret:
      name: 'oidc-client-secret'
    cookieDomain: 'sko.ai'
    redirectURL: 'https://oidc.sko.ai/openid_connect/callback'
    refreshToken: true
