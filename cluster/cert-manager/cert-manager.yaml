apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: cert-manager
  namespace: cert-manager
spec:
  chart:
    spec:
      chart: cert-manager
      sourceRef:
        kind: HelmRepository
        name: jetstack
      version: v1.19.1
  interval: 1h
  values:
    image:
      repository: ghcr.io/vaskozl/cert-manager-controller
      tag: 1.19.1@sha256:8cf78a5e38cc517561b76261e86336f0297aeb86c987a3fc2e4e3f7ee0ba2b3f
    cainjector:
      replicaCount: 1
      image:
        repository: ghcr.io/vaskozl/cert-manager-cainjector
        tag: 1.19.1@sha256:bd4b779f290bacf15c993caa0615966031cd1ad9d00c5d68be7e12253adb1c49
    acmesolver:
      image:
        repository: ghcr.io/vaskozl/cert-manager-acmesolver
        tag: 1.19.1@sha256:7c8737c2f95d9e161736c9d93c5b19ec4c17360f186e696625c3f5b662c9a84b
    webhook:
      image:
        repository: ghcr.io/vaskozl/cert-manager-webhook
        tag: 1.19.1@sha256:83f6eb41b4e0b210e4e6e4c3a7265606e71389565f4a05c7e2777cc6b1b23bc8
    installCRDs: true
    extraArgs:
      - --dns01-recursive-nameservers=1.1.1.1:53
    podDnsPolicy: None
    podDnsConfig:
      nameservers:
        - 1.1.1.1
        - 8.8.8.8
    # Enabled once prometheus-operator is installed
    prometheus:
      enabled: false
      servicemonitor:
        enabled: false
        namespace: cert-manager
