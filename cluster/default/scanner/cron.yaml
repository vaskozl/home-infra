apiVersion: batch/v1
kind: CronJob
metadata:
  name: scanner
spec:
  schedule: "0 7 * * 2,6"
  jobTemplate:
    spec:
      template:
        spec:
          restartPolicy: Never
          serviceAccountName: scanner-sa
          containers:
            - name: scanner-container
              image: ghcr.io/vaskozl/perl-mojolicious:9.41@sha256:4d47e2af8e24854014a5567e8d3257e87147fc26106391cf60b5f1924c1bfe13
              args:
                - /script/scan-containers.pl
                - -v
                - -u
                - -m=scans@sko.ai
                - -f=scans@sko.ai
                - -s=mx-maddy.mailserver.svc.cluster.local:2225
              volumeMounts:
                - name: script
                  mountPath: /script
          volumes:
            - name: script
              configMap:
                name: script
