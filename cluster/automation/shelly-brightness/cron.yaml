apiVersion: batch/v1
kind: CronJob
metadata:
  name: shelly-brightness
spec:
  schedule: '0 */1 * * *'
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 1
  successfulJobsHistoryLimit: 3
  jobTemplate:
    metadata:
    spec:
      template:
        metadata:
        spec:
          containers:
            - args: [/script/shelly-brightness.pl]
              image: ghcr.io/vaskozl/perl-libwww:6.81@sha256:14f8c87751463b0f0f60a7eb2aff8cc616d1b76be6baccecf0541a402c8027bd
              name: shelly-brightness
              resources:
                requests:
                  cpu: 50m
                  memory: 128Mi
                limits:
                  cpu: 100m
                  memory: 256Mi
              volumeMounts:
                - mountPath: /script
                  name: script
          restartPolicy: Never
          volumes:
            - configMap:
                defaultMode: 420
                name: script
              name: script
