apiVersion: batch/v1
kind: CronJob
metadata:
  name: shelly-brightness
spec:
  schedule: '0 */1 * * *'
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 1
  successfulJobsHistoryLimit: 3
  jobTemplate:
    metadata:
    spec:
      template:
        metadata:
        spec:
          containers:
            - args: [/script/shelly-brightness.pl]
              image: ghcr.io/vaskozl/perl-libwww:6.81@sha256:2a002a5a4f16c8d062c7b9b9f7858672ac17af03c48ea594b3a76c03ee7f2190
              name: shelly-brightness
              resources:
                requests:
                  cpu: 50m
                  memory: 128Mi
                limits:
                  cpu: 100m
                  memory: 256Mi
              volumeMounts:
                - mountPath: /script
                  name: script
          restartPolicy: Never
          volumes:
            - configMap:
                defaultMode: 420
                name: script
              name: script
